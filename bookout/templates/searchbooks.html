
{% extends "maintemplate.html" %}

{% block title %}Search Books{% endblock %}

{% block content %}

<script type="text/javascript">
	function add_book(bookOLKey){
		$.post("/library/" + bookOLKey, function(data) {
			alert(data);
		});
	}
	
	function request_book(bookOLKey){
		alert("Something happens.");
	}
</script>

<form id="searchForm" action="/searchbooks">
<div class="row">
	<div class="span2">
		<br/>
		<h3>Book Search:</h3>
	</div>
	<div class="span10">
		<br/>
		<h3>
			
			<input name="value" type="text" class="input-xxlarge search-query" placeholder="Enter Title, Author, or ISBN..." value="{{ search }}">
			<button type="submit" class="btn">Search</button>
			
		</h3>
	</div>
</div>
<br/>

<div class="row">
	<div class="span2">
		<div class="well">
			<h5>Filter Results:</h5>
			<label class="checkbox"><input type="checkbox">Show out-of-network books</label>
		</div>
		<div class="well">
			<h5>Refine Search:</h5>
			<label class="radio"><input type="radio" id="searchAll" name="refineSearch" value="all">All results</label>
			<label class="radio"><input type="radio" id="searchTitle" name="refineSearch" value="title">Title only</label>
			<label class="radio"><input type="radio" id="searchAuthor" name="refineSearch" value="author">Author only</label>
			<label class="radio"><input type="radio" id="searchISBN" name="refineSearch" value="isbn">ISBN only</label>
		</div>
	</div>
	
	<div class="span10">
		{% if books == False %}
		{% else %}
			<table class="table">
			{% for book in books %}
				<tr>
					<td><img src="{{ books[book].thumbnail_link }}" style="height:auto;width:100px;"/></td>
					<td>Title: {{ books[book].title }}<br/>
						Author: {{ books[book].author }}</td>
					<td><a href="#" class="btn"
							{% if user.is_authenticated() == False %}disabled{% endif %} 
							onclick="{% if user.is_authenticated() %}add_book('{{ books[book].OLKey }}'){% endif %}" 
							title="{% if user.is_authenticated() %}Add to library and make available to your network{% 
							else %}Join or login to add to your library{% endif %}">Add to Library</a><br/><br/>
						<a href="#" class="btn btn-inverse" 
							{% if user.is_authenticated() == False or True %}disabled{% endif %} 
							onclick="{% if user.is_authenticated() and False %}request_book('{{ books[book].OLKey }}'){% endif %}"
							title="{% if user.is_authenticated() and False %}Request to borrow book from one of your connections{% 
							elif user.is_authenticated() %}Not available in your network{% 
							else %}Join or login to request to borrow books{% endif %}">Request to Borrow</a></td>
				</tr>
			{% endfor %}
			</table>
		{% endif %}
	</div>
</div>
</form>
<script type="text/javascript">
switch("{{attribute}}"){
case "all":
	document.getElementById("searchAll").checked=true;	
	break;
case "title":
	document.getElementById("searchTitle").checked=true;
	break;
case "author":
	document.getElementById("searchAuthor").checked=true;
	break;
case "isbn":
	document.getElementById("searchISBN").checked=true;
	break;
default:
	document.getElementById("searchAll").checked=true;
}
</script>
{% endblock %}
